// Generated by CoffeeScript 1.10.0
var Bookmark, cozydb, log;

cozydb = require('cozydb');

log = require('printit')({
  prefix: 'bookmark:model'
});

module.exports = Bookmark = cozydb.getModel('Bookmark', {
  url: String,
  title: String
});

Bookmark.byName = function(options, callback) {
  return Bookmark.request('byName', options, callback);
};

Bookmark.getOrCreate = function(data, callback) {
  return Bookmark.byName({
    key: data.url
  }, function(err, bookmarks) {
    if (err) {
      log.error(err);
      return Bookmark.create(data, callback);
    } else if (bookmarks.length === 0) {
      return Bookmark.create(data, callback);
    } else {
      return callback(null, bookmarks[0]);
    }
  });
};
